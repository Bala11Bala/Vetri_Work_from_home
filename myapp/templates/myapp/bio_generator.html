{% extends 'myapp/layouts/base.html' %}
{% load static %}

{% block extra_css %}
<style>
    .feature-card {
        border-radius: 15px;
        background: #fff;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        transition: transform 0.3s;
    }

    .feature-card:hover {
        transform: translateY(-5px);
    }

    .btn-generate {
        background: #1a237e;
        color: #fff;
        border-radius: 30px;
        padding: 10px 25px;
        font-weight: 600;
        transition: 0.3s;
    }

    .btn-generate:hover {
        background: #0d47a1;
        color: #fff;
    }

.bio-output {
    background: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 30px;
    display: flex;           /* use flexbox */
    justify-content: space-between; /* space between text and button */
    align-items: flex-start; /* align button to top of text */
    gap: 10px;               /* optional spacing */
    flex-wrap: wrap;         /* allow text to wrap */
}

.bio-output p {
    margin: 0;
    flex: 1; /* text takes remaining space */
}

.copy-btn {
    margin: 0;
    flex-shrink: 0; /* don't shrink button */
}


    .features {
        background-color: #fff;
    }

    .feature-card {
        background: #fff;
        transition: transform 0.3s, box-shadow 0.3s;
    }

    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }

    .feature-icon {
        width: 60px;
        height: 60px;
    }

    .bg-pink {
        background-color: #e056fd;
        color: #fff;
    }

    /* Font size bigger on laptop/desktop */
    @media (min-width: 992px) {
        .feature-card h5 {
            font-size: 1.25rem;
        }

        .feature-card p {
            font-size: 1rem;
        }
    }
</style>

{% endblock extra_css %}


{% block title %}
AI Bio Generator
{% endblock title %}

{% block content %}
<!-- Hero -->
<section class="hero py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7">
                <h1 class="fw-bold">AI Bio Generator</h1>
                <p class="text-muted">Create a compelling professional summary in seconds. Let AI craft the perfect bio
                    that showcases your skills and experience to land your dream remote job.</p>
                <a href="#bio-tool" class="btn btn-primary me-2">Generate My Bio</a>
                <a href="#" class="btn btn-outline-primary">See How It Works</a>
            </div>
            <div class="col-lg-5 text-center mt-4 mt-lg-0">
                <img src="{% static 'images/ai_img.png' %}" alt="AI Bio" class="img-fluid rounded shadow">
            </div>
        </div>
    </div>
</section>

<!-- Form Section -->
<section id="bio-tool" class="py-5 bg-light">
    <div class="container">
        <h2 class="text-center fw-bold mb-4">Bio Generator Tool</h2>
        <p class="text-center text-muted mb-5">Fill in your details and let AI craft your perfect professional bio</p>

        <form id="bioForm" class="p-4 bg-white rounded shadow" method="post">
            {% csrf_token %}
            <div class="row g-4">

                <div class="col-md-6">
                    <label class="form-label">Full Name</label>
                    <input type="text" name="fullName" id="fullName" class="form-control"
                        placeholder="Enter your Full Name" required>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Experience Level</label>
                    <select name="experience" id="experience" class="form-select" required>
                        <option value="Entry Level">Entry Level</option>
                        <option value="Mid Level">Mid Level</option>
                        <option value="Senior Level">Senior Level</option>
                    </select>
                </div>

                <div class="col-12">
                    <label class="form-label">Skills</label>
                    <input type="text" name="skills" id="skills" class="form-control"
                        placeholder="e.g. JavaScript, React, Node.js" required>
                </div>

                <div class="col-12">
                    <label class="form-label">Career Highlights</label>
                    <textarea name="highlights" id="highlights" class="form-control" rows="2"
                        placeholder="e.g. Seeking a senior developer role..." required></textarea>
                </div>

                <div class="col-md-4">
                    <label class="form-label">Tone</label>
                    <select name="tone" id="tone" class="form-select">
                        <option value="Professional">Professional</option>
                        <option value="Friendly">Friendly</option>
                        <option value="Creative">Creative</option>
                    </select>
                </div>

                <div class="col-md-4">
                    <label class="form-label">Length</label>
                    <select name="length" id="length" class="form-select">
                        <option value="Short">Short</option>
                        <option value="Medium">Medium</option>
                        <option value="Long">Long</option>
                    </select>
                </div>

                <div class="col-md-4">
                    <label class="form-label">Language</label>
                    <select name="language" id="language" class="form-select">
                        <option value="English">English</option>
                        <option value="Tamil">Tamil</option>
                        <option value="Hindi">Hindi</option>
                    </select>
                </div>

            </div>
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-generate w-100">
                    <i class="bi bi-magic"></i> Generate My Bio
                </button>
            </div>
        </form>

    </div>
</section>

<!-- Modal for Bio Results -->
<div class="modal fade" id="bioModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content p-4">
            <div class="modal-header">
                <h5 class="modal-title fw-bold">Your AI-Generated Bios</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="bioVariant1" class="bio-output">
                    <button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyBio('bioVariant1')">Copy</button>
                </div>
                <div id="bioVariant2" class="bio-output">
                    <button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyBio('bioVariant2')">Copy</button>
                </div>
            </div>
        </div>
    </div>
</div>


<section class="features py-5">
    <div class="container">
        <div class="row g-4">

            <!-- Tone Selection -->
            <div class="col-md-6 col-lg-3">
                <div class="feature-card h-100 p-4 shadow-sm rounded-4 text-center">
                    <div class="icon mb-3">
                        <img src="{% static 'images/color.png' %}" alt="Tone Selection" class="feature-icon">
                    </div>
                    <h5 class="fw-bold">Tone Selection</h5>
                    <p class="text-muted">Choose from Formal, Friendly, or Creative tones based on your industry and
                        target role.</p>
                    <div class="d-flex justify-content-center gap-2">
                        <span class="badge bg-primary">Formal</span>
                        <span class="badge bg-success">Friendly</span>
                        <span class="badge bg-pink">Creative</span>
                    </div>
                </div>
            </div>

            <!-- Word Count Options -->
            <div class="col-md-6 col-lg-3">
                <div class="feature-card h-100 p-4 shadow-sm rounded-4 text-center">
                    <div class="icon mb-3">
                        <img src="{% static 'images/text.png' %}" alt="Word Count Options" class="feature-icon">
                    </div>
                    <h5 class="fw-bold">Word Count Options</h5>
                    <p class="text-muted">Generate short bios for quick applications or detailed ones for comprehensive
                        profiles.</p>
                    <ul class="list-unstyled small">
                        <li><b>Short:</b> 50–75 words</li>
                        <li><b>Medium:</b> 100–150 words</li>
                        <li><b>Detailed:</b> 200+ words</li>
                    </ul>
                </div>
            </div>

            <!-- ATS Optimization -->
            <div class="col-md-6 col-lg-3">
                <div class="feature-card h-100 p-4 shadow-sm rounded-4 text-center">
                    <div class="icon mb-3">
                        <img src="{% static 'images/search.png' %}" alt="ATS Optimization" class="feature-icon">
                    </div>
                    <h5 class="fw-bold">ATS Optimization</h5>
                    <p class="text-muted">Add relevant keywords to help your bio pass through Applicant Tracking
                        Systems.</p>
                    <span class="badge bg-success">✓ Keyword suggestions included</span>
                </div>
            </div>

            <!-- Multi-Language -->
            <div class="col-md-6 col-lg-3">
                <div class="feature-card h-100 p-4 shadow-sm rounded-4 text-center">
                    <div class="icon mb-3">
                        <img src="{% static 'images/lang.png' %}" alt="Multi-Language" class="feature-icon">
                    </div>
                    <h5 class="fw-bold">Multi-Language</h5>
                    <p class="text-muted">Generate bios in English and local languages to target regional opportunities.
                    </p>
                    <div class="d-flex justify-content-center gap-2">
                        <span class="badge bg-primary">English</span>
                        <span class="badge bg-success">Hindi</span>
                        <span class="badge bg-pink">Telugu</span>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>


{% endblock content %}


{% block script %}
<script>
    // Handle form submit
    document.getElementById("bioForm").addEventListener("submit", function (e) {
        e.preventDefault();

        let formData = new FormData(this);

        fetch("{% url 'generate_bio' %}", {
            method: "POST",
            body: formData,
            headers: {
                "X-Requested-With": "XMLHttpRequest",
                "X-CSRFToken": document.querySelector('[name=csrfmiddlewaretoken]').value
            }
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById("bioVariant1").innerHTML =
                    `<p>${data.bio1}</p>
                     <button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyBio('bioVariant1')">Copy</button>`;

                document.getElementById("bioVariant2").innerHTML =
                    `<p>${data.bio2}</p>
                     <button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyBio('bioVariant2')">Copy</button>`;

                new bootstrap.Modal(document.getElementById("bioModal")).show();
            })
            .catch(error => console.error("Error:", error));
    });

    // Copy function
    function copyBio(elementId) {
        const text = document.getElementById(elementId).innerText.replace("Copy", "").trim();
        navigator.clipboard.writeText(text).then(() => {
            alert("Copied to clipboard!");
        }).catch(err => {
            console.error("Failed to copy: ", err);
        });
    }
</script>
{% endblock script %}
