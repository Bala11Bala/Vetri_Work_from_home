{% extends 'myapp/layouts/base.html' %}
{% load static %}


{% block content %}

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert"
         style="background-color: 
                {% if message.tags == 'error' %}#f8d7da{% elif message.tags == 'success' %}#d1e7dd{% elif message.tags == 'warning' %}#fff3cd{% else %}#cfe2ff{% endif %};
                color: {% if message.tags == 'error' %}#842029{% elif message.tags == 'success' %}#0f5132{% elif message.tags == 'warning' %}#664d03{% else %}#084298{% endif %};
                padding: 15px;
                border-radius: 8px;
                border: 1px solid 
                {% if message.tags == 'error' %}#f5c2c7{% elif message.tags == 'success' %}#badbcc{% elif message.tags == 'warning' %}#ffecb5{% else %}#b6d4fe{% endif %};
                margin-bottom: 20px;">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}

<div class="container my-5">
  <!-- Job Header -->
  <div class="card shadow-sm p-4 mb-4">
    <div class="d-flex justify-content-between">
      <div>
        <h4 class="fw-bold">{{ job.title }}</h4>
        <p class="text-muted">{{ job.company }}</p>
        <p><i class="bi bi-geo-alt"></i> {{ job.location }} â€¢ {{ job.job_type }}</p>
        <div>
          {% for skill in job.skill_list %}
            <span class="badge bg-success m-1">{{ skill }}</span>
          {% endfor %}
        </div>
      </div>
      <div class="text-end">
        <h5 class="text-primary">{{ job.salary_range }}</h5>
        <p class="text-muted">{{ job.posted_days }}</p>

        {% if course %}
          <a href="{% url 'apply_job' job.id %}" 
             class="btn btn-primary border-white" style="background-color: #172B85;">
             Apply Now
          </a>
        {% else %}
          <button class="btn btn-secondary" disabled>No Course Assigned</button>
        {% endif %}
      </div>
    </div>
    <hr>
    <p class="mb-1">Posted: {{ job.posted_days }}</p>
    <p class="mb-1">Openings: {{ job.openings }}</p>
    <p class="mb-0">Applicants: {{ job.applicants }}</p>
  </div>

  <!-- Job Description -->
  <div class="card shadow-sm p-4 mb-4">
    <h5 class="fw-bold">Job Description</h5>
    <h6 class="fw-bold mt-3">Roles and Responsibilities</h6>
    <ul>
      {% for line in responsibilities %}
        <li>{{ line }}</li>
      {% endfor %}
    </ul>
    <p><b>Role:</b> {{ job.role }}</p>
    <p><b>Candidate Type:</b> {{ job.candidate_type }}</p>
    <p><b>Employment Type:</b> {{ job.employment_type }}</p>
    <p><b>Education UG:</b> {{ job.education }}</p>
  </div>

  <!-- About Company -->
  <div class="card shadow-sm p-4">
    <h5 class="fw-bold">About Company</h5>
    <p>{{ job.about_company }}</p>
  </div>
</div>
{% endblock content %}



{% block script %}
<script>
  // Auto close all alerts after 3 seconds (3000ms)
  window.addEventListener('DOMContentLoaded', (event) => {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(alert => {
      setTimeout(() => {
        const bsAlert = bootstrap.Alert.getOrCreateInstance(alert);
        bsAlert.close();
      }, 3000);
    });
  });
</script>
{% endblock %}